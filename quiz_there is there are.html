<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>There is/are äº’å‹•å½±ç‰‡æ¸¬é©—</title>
    <!-- è¼‰å…¥ Tailwind CSS ç¢ºä¿éŸ¿æ‡‰å¼è¨­è¨ˆå’Œç¾è§€ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å­—é«”è¨­å®šèˆ‡æ•´é«”å±…ä¸­ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f3f5;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* è®“å…§å®¹é ä¸Š */
            min-height: 100vh;
            padding: 20px 10px;
        }

        /* æ¸¬é©—ä¸»å®¹å™¨ */
        .quiz-container {
            max-width: 700px;
            width: 100%;
            background-color: white;
            padding: 25px;
            border-radius: 14px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }

        /* å½±ç‰‡å¤–æ¡† (16:9 æ¯”ä¾‹) */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; 
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        #player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* æ¸¬é©—å½ˆçª—é®ç½© */
        #quiz-overlay {
            display: none; /* é è¨­éš±è— */
            position: fixed; /* å›ºå®šåœ¨è¦–çª—ä¸Šå±¤ */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* åŠé€æ˜é®ç½© */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        /* æ¸¬é©—å…§å®¹å€å¡Š */
        .quiz-modal {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            width: 450px;
            animation: fadeIn 0.3s ease-out;
        }

        /* ç­”æ¡ˆé¸é …æŒ‰éˆ• */
        .option-btn {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            text-align: left;
            background-color: #f9fafb;
            transition: all 0.2s;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #e0f2fe;
            border-color: #38bdf8;
            cursor: pointer;
        }
        
        /* ç­”é¡Œçµæœæ¨£å¼ */
        .correct-answer {
            background-color: #dcfce7; /* æ·ºç¶  */
            border-color: #22c55e; /* ç¶ è‰²é‚Šæ¡† */
            font-weight: 600;
        }
        .incorrect-selection {
            background-color: #fee2e2; /* æ·ºç´… */
            border-color: #ef4444; /* ç´…è‰²é‚Šæ¡† */
            opacity: 0.7;
        }
        
        /* å‹•ç•«æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">There is/are äº’å‹•æ¸¬é©— (æœ€çµ‚ç‰ˆ)</h1>
    <p class="text-sm text-gray-500 mb-6 text-center">å½±ç‰‡å°‡åœ¨é—œéµèªæ³•é»è‡ªå‹•æš«åœï¼Œè«‹å›ç­”å•é¡Œä»¥ç¹¼çºŒã€‚</p>

    <!-- YouTube Player å®¹å™¨ -->
    <div class="video-wrapper">
        <div id="player"></div>
    </div>

    <!-- å½±ç‰‡è¼‰å…¥ä¸­æç¤º -->
    <div id="loading-msg" class="text-center text-blue-500 mt-4 p-3 bg-blue-50 rounded-lg">
        ğŸ¬ å½±ç‰‡è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...
    </div>
</div>

<!-- æ¸¬é©—å½ˆçª— -->
<div id="quiz-overlay">
    <div class="quiz-modal">
        <h3 class="text-xl font-bold text-gray-800 mb-4" id="quiz-question"></h3>
        <div id="quiz-options">
            <!-- é¸é …å°‡ç”± JS è¼‰å…¥ -->
        </div>
        
        <!-- ç­”æ¡ˆå›é¥‹èˆ‡è§£æ -->
        <div id="rationale-box" class="mt-4 p-3 bg-gray-100 border-l-4 border-gray-400 rounded-lg hidden">
            <p class="font-semibold text-sm mb-1" id="feedback-result"></p>
            <p class="text-sm text-gray-700" id="feedback-rationale"></p>
        </div>

        <!-- ç¹¼çºŒæ’­æ”¾æŒ‰éˆ• -->
        <button id="continue-btn" class="w-full mt-6 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition duration-150 hidden" onclick="continueVideo()">
            ç¹¼çºŒæ’­æ”¾å½±ç‰‡
        </button>
    </div>
</div>

<script>
    // YouTube å½±ç‰‡ ID (æ‚¨æŒ‡å®šçš„ ID)
    const VIDEO_ID = 'xCrsoRmPFok'; 
    
    // æ¸¬é©—ç¯€é» (Time in seconds, question, options, answer index, and rationale)
    const QUIZ_POINTS = [
        {
            time: 33, // 0:33
            question: "é¸æ“‡æ­£ç¢ºçš„å‹•è©å½¢å¼ï¼šThere ____ a big clock on the wall.",
            options: ["is", "are", "have"],
            answerIndex: 0,
            rationale: "ä¸»è©æ˜¯ 'a big clock' (å–®æ•¸)ï¼Œæ‰€ä»¥å‹•è©ä½¿ç”¨ 'is'ã€‚",
            answered: false
        },
        {
            time: 112, // 1:52
            question: "å¡«å…¥æ­£ç¢ºçš„å¦å®šå½¢å¼ï¼šThere ____ any students in the classroom.",
            options: ["isn't", "aren't", "not is"],
            answerIndex: 1,
            rationale: "ä¸»è©æ˜¯ 'any students' (è¤‡æ•¸)ï¼Œæ‰€ä»¥å¦å®šå½¢å¼ä½¿ç”¨ 'aren't' (are not)ã€‚",
            answered: false
        },
        {
            time: 210, // 3:30
            question: "é¸æ“‡æ­£ç¢ºçš„ç–‘å•å¥ï¼š____ a pencil on the table?",
            options: ["Is there", "Are there", "There is"],
            answerIndex: 0,
            rationale: "ä¸»è©æ˜¯ 'a pencil' (å–®æ•¸)ï¼Œæ‰€ä»¥ç–‘å•å¥ä½¿ç”¨ 'Is there'ã€‚",
            answered: false
        }
    ];

    let player;
    let quizInterval;
    let currentQuizIndex = -1; // ç•¶å‰å½ˆå‡ºçš„é¡Œç›®ç´¢å¼•

    // 1. è¼‰å…¥ YouTube IFrame Player API
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            videoId: VIDEO_ID,
            playerVars: {
                // ä½¿ç”¨ youtube-nocookie æé«˜åµŒå…¥ç›¸å®¹æ€§
                'origin': window.location.origin, 
                'enablejsapi': 1,
                'rel': 0, // ä¸é¡¯ç¤ºç›¸é—œå½±ç‰‡
                'controls': 1 // é¡¯ç¤ºæ’­æ”¾æ§åˆ¶é …
            },
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
        document.getElementById('loading-msg').textContent = 'â–¶ï¸ å½±ç‰‡å·²å°±ç·’ï¼Œè«‹é»æ“Šæ’­æ”¾ã€‚';
        document.getElementById('loading-msg').classList.remove('text-blue-500');
        document.getElementById('loading-msg').classList.add('text-green-600', 'bg-green-50');
    }

    // 2. æ’­æ”¾å™¨æº–å‚™å°±ç·’
    function onPlayerReady(event) {
        // é–‹å§‹ç›£æ¸¬æ’­æ”¾é€²åº¦
        quizInterval = setInterval(checkQuizPoint, 1000); // æ¯ç§’æª¢æŸ¥ä¸€æ¬¡
    }

    // 3. ç›£æ¸¬æ’­æ”¾ç‹€æ…‹è®ŠåŒ– (ä¾‹å¦‚ï¼šå­¸ç”Ÿæ‰‹å‹•æš«åœ/æ’­æ”¾)
    function onPlayerStateChange(event) {
        // å¦‚æœå­¸ç”Ÿæ‰‹å‹•æš«åœï¼Œä¸å½±éŸ¿æ¸¬é©—é‚è¼¯
    }

    // 4. å®šæ™‚æª¢æŸ¥æ˜¯å¦åˆ°é”æ¸¬é©—æ™‚é–“é»
    function checkQuizPoint() {
        if (!player || player.getPlayerState() !== YT.PlayerState.PLAYING) {
            return;
        }

        const currentTime = player.getCurrentTime();

        for (let i = 0; i < QUIZ_POINTS.length; i++) {
            const point = QUIZ_POINTS[i];
            
            // æª¢æŸ¥æ˜¯å¦åˆ°é”æ™‚é–“é»ä¸”å°šæœªå›ç­”
            if (!point.answered && currentTime >= point.time) {
                // æš«åœå½±ç‰‡
                player.pauseVideo();
                
                // è¨­å®šç•¶å‰é¡Œç›®ç´¢å¼•
                currentQuizIndex = i;
                
                // é¡¯ç¤ºæ¸¬é©—å½ˆçª—
                showQuiz(point);
                
                // åœæ­¢å®šæ™‚å™¨ç›´åˆ°æ¸¬é©—çµæŸ
                clearInterval(quizInterval); 
                return;
            }
        }
    }

    // 5. é¡¯ç¤ºæ¸¬é©—é¡Œç›®å½ˆçª—
    function showQuiz(point) {
        document.getElementById('quiz-question').textContent = point.question;
        
        const optionsContainer = document.getElementById('quiz-options');
        optionsContainer.innerHTML = ''; // æ¸…ç©ºèˆŠé¸é …
        
        point.options.forEach((option, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn font-medium text-gray-700';
            btn.textContent = option;
            btn.onclick = () => checkAnswer(btn, index);
            optionsContainer.appendChild(btn);
        });

        // é‡ç½®å›é¥‹å€å¡Š
        document.getElementById('rationale-box').classList.add('hidden');
        document.getElementById('continue-btn').classList.add('hidden');
        
        document.getElementById('quiz-overlay').style.display = 'flex';
    }

    // 6. æª¢æŸ¥ç­”æ¡ˆ
    function checkAnswer(clickedButton, selectedIndex) {
        const point = QUIZ_POINTS[currentQuizIndex];
        const isCorrect = selectedIndex === point.answerIndex;
        const allButtons = document.getElementById('quiz-options').querySelectorAll('.option-btn');
        
        // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•
        allButtons.forEach(btn => {
            btn.disabled = true;
            // æ¨™è¨˜æ­£ç¢ºç­”æ¡ˆ
            if (point.answerIndex === parseInt(btn.getAttribute('data-index')) || btn.textContent === point.options[point.answerIndex]) {
                btn.classList.add('correct-answer');
            }
        });

        // æ¨™è¨˜ä½¿ç”¨è€…é¸æ“‡çš„ç­”æ¡ˆ
        if (!isCorrect) {
            clickedButton.classList.add('incorrect-selection');
        }

        // é¡¯ç¤ºå›é¥‹å’Œè§£æ
        const rationaleBox = document.getElementById('rationale-box');
        const feedbackResult = document.getElementById('feedback-result');
        const feedbackRationale = document.getElementById('feedback-rationale');
        
        feedbackResult.textContent = isCorrect ? 'âœ… å›ç­”æ­£ç¢ºï¼' : 'âŒ ç­”éŒ¯äº†ï¼';
        feedbackRationale.textContent = point.rationale;

        rationaleBox.classList.remove('hidden');
        rationaleBox.classList.remove(isCorrect ? 'border-red-400' : 'border-green-400');
        rationaleBox.classList.add(isCorrect ? 'border-green-400' : 'border-red-400');
        
        // é¡¯ç¤ºç¹¼çºŒæŒ‰éˆ•
        document.getElementById('continue-btn').classList.remove('hidden');
        
        // æ¨™è¨˜ç‚ºå·²å›ç­”
        point.answered = true;
    }

    // 7. ç¹¼çºŒæ’­æ”¾å½±ç‰‡
    function continueVideo() {
        document.getElementById('quiz-overlay').style.display = 'none';
        
        // ç¹¼çºŒå®šæ™‚æª¢æŸ¥
        quizInterval = setInterval(checkQuizPoint, 1000); 
        
        // ç¹¼çºŒæ’­æ”¾å½±ç‰‡
        player.playVideo();
    }

    // è¼‰å…¥ YouTube IFrame Player API è…³æœ¬
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
</script>

</body>
</html>
