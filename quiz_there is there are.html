<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>There is/are äº’å‹•å½±ç‰‡æ¸¬é©— - ç©©å®šç‰ˆ</title>
    <!-- è¼‰å…¥ Tailwind CSS ç¢ºä¿éŸ¿æ‡‰å¼è¨­è¨ˆå’Œç¾è§€ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å­—é«”è¨­å®šèˆ‡æ•´é«”å±…ä¸­ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f3f5;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px 10px;
        }

        /* æ¸¬é©—ä¸»å®¹å™¨ */
        .quiz-container {
            max-width: 700px;
            width: 100%;
            background-color: white;
            padding: 25px;
            border-radius: 14px;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
        }

        /* å½±ç‰‡å¤–æ¡† (16:9 æ¯”ä¾‹) */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; 
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        /* æ¸¬é©—å½ˆçª—é®ç½© */
        #quiz-overlay {
            display: none; /* é è¨­éš±è— */
            position: fixed; /* å›ºå®šåœ¨è¦–çª—ä¸Šå±¤ */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* åŠé€æ˜é®ç½© */
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        /* æ¸¬é©—å…§å®¹å€å¡Š */
        .quiz-modal {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 90%;
            width: 450px;
            animation: fadeIn 0.3s ease-out;
        }

        /* ç­”æ¡ˆé¸é …æŒ‰éˆ• */
        .option-btn {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            text-align: left;
            background-color: #f9fafb;
            transition: all 0.2s;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #e0f2fe;
            border-color: #38bdf8;
            cursor: pointer;
        }
        
        /* ç­”é¡Œçµæœæ¨£å¼ */
        .correct-answer {
            background-color: #dcfce7; /* æ·ºç¶  */
            border-color: #22c55e; /* ç¶ è‰²é‚Šæ¡† */
            font-weight: 600;
        }
        .incorrect-selection {
            background-color: #fee2e2; /* æ·ºç´… */
            border-color: #ef4444; /* ç´…è‰²é‚Šæ¡† */
            opacity: 0.7;
        }
        
        /* å‹•ç•«æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-3">There is/are äº’å‹•æ¸¬é©— (ç©©å®šç‰ˆ)</h1>
    <p class="text-md font-semibold text-red-600 mb-4 text-center p-2 bg-red-50 rounded-lg shadow-sm">
        âš ï¸ æé†’ï¼šå½±ç‰‡ä¸æœƒè‡ªå‹•æš«åœï¼Œç•¶æ¸¬é©—å½ˆçª—å‡ºç¾æ™‚ï¼Œ**è«‹æ‰‹å‹•æš«åœå½±ç‰‡**ã€‚
    </p>

    <!-- åµŒå…¥ YouTube å½±ç‰‡ (æœ€ç©©å®šçš„ nocookie åµŒå…¥æ–¹å¼) -->
    <div class="video-wrapper">
        <iframe 
            src="https://www.youtube-nocookie.com/embed/xCrsoRmPFok?rel=0&controls=1&showinfo=0&playsinline=1" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen" 
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen>
        </iframe>
    </div>
    
    <div id="status-msg" class="text-center text-blue-500 mt-4 p-3 bg-blue-50 rounded-lg">
        ğŸ“½ï¸ è«‹æ’­æ”¾å½±ç‰‡ï¼Œäº’å‹•æ¸¬é©—å°‡åœ¨ 33 ç§’å¾Œé–‹å§‹ã€‚
    </div>
</div>

<!-- æ¸¬é©—å½ˆçª— -->
<div id="quiz-overlay">
    <div class="quiz-modal">
        <div class="text-center bg-yellow-100 p-2 rounded-lg mb-4 text-sm font-semibold text-yellow-800">
            è«‹ç«‹å³ **æ‰‹å‹•æš«åœ** å½±ç‰‡ï¼
        </div>
        <h3 class="text-xl font-bold text-gray-800 mb-4" id="quiz-question"></h3>
        <div id="quiz-options">
            <!-- é¸é …å°‡ç”± JS è¼‰å…¥ -->
        </div>
        
        <!-- ç­”æ¡ˆå›é¥‹èˆ‡è§£æ -->
        <div id="rationale-box" class="mt-4 p-3 bg-gray-100 border-l-4 border-gray-400 rounded-lg hidden">
            <p class="font-semibold text-sm mb-1" id="feedback-result"></p>
            <p class="text-sm text-gray-700" id="feedback-rationale"></p>
        </div>

        <!-- ç¹¼çºŒæ’­æ”¾æŒ‰éˆ• -->
        <button id="continue-btn" class="w-full mt-6 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition duration-150 hidden" onclick="continueVideo()">
            é—œé–‰æ¸¬é©—ä¸¦ç¹¼çºŒæ’­æ”¾
        </button>
    </div>
</div>

<script>
    // æ¸¬é©—ç¯€é» (Time in milliseconds since page load to trigger quiz)
    // ç‚ºäº†æ‡‰å°ä¸æº–ç¢ºæ€§ï¼Œæˆ‘å°‡æ™‚é–“ç¨å¾®æ”¾å¯¬ï¼Œä¸¦ä»¥æ¯«ç§’è¨ˆç®—
    const QUIZ_POINTS = [
        {
            // å½±ç‰‡æ™‚é–“ 0:33
            triggerTimeMs: 33000, 
            question: "é¸æ“‡æ­£ç¢ºçš„å‹•è©å½¢å¼ï¼šThere ____ a big clock on the wall.",
            options: ["is", "are", "have"],
            answerIndex: 0,
            rationale: "ä¸»è©æ˜¯ 'a big clock' (å–®æ•¸)ï¼Œæ‰€ä»¥å‹•è©ä½¿ç”¨ 'is'ã€‚",
            answered: false
        },
        {
            // å½±ç‰‡æ™‚é–“ 1:52 (ç´„ 112 ç§’)
            triggerTimeMs: 112000, 
            question: "å¡«å…¥æ­£ç¢ºçš„å¦å®šå½¢å¼ï¼šThere ____ any students in the classroom.",
            options: ["isn't", "aren't", "not is"],
            answerIndex: 1,
            rationale: "ä¸»è©æ˜¯ 'any students' (è¤‡æ•¸)ï¼Œæ‰€ä»¥å¦å®šå½¢å¼ä½¿ç”¨ 'aren't' (are not)ã€‚",
            answered: false
        },
        {
            // å½±ç‰‡æ™‚é–“ 3:30 (ç´„ 210 ç§’)
            triggerTimeMs: 210000, 
            question: "é¸æ“‡æ­£ç¢ºçš„ç–‘å•å¥ï¼š____ a pencil on the table?",
            options: ["Is there", "Are there", "There is"],
            answerIndex: 0,
            rationale: "ä¸»è©æ˜¯ 'a pencil' (å–®æ•¸)ï¼Œæ‰€ä»¥ç–‘å•å¥ä½¿ç”¨ 'Is there'ã€‚",
            answered: false
        }
    ];

    let startTime = Date.now();
    let quizTimeout = []; // å„²å­˜æ‰€æœ‰è¨ˆæ™‚å™¨ ID
    let currentQuizIndex = -1; 
    let quizActive = false; // é¿å…åŒæ™‚å½ˆå‡ºå¤šå€‹æ¸¬é©—

    /**
     * åˆå§‹åŒ–æ‰€æœ‰æ¸¬é©—è¨ˆæ™‚å™¨
     */
    function initQuizTimers() {
        startTime = Date.now(); // é‡è¨­é–‹å§‹æ™‚é–“

        QUIZ_POINTS.forEach((point, index) => {
            // åªè¨­å®šå°šæœªå›ç­”çš„é¡Œç›®
            if (!point.answered) {
                const delay = point.triggerTimeMs;

                const timerId = setTimeout(() => {
                    if (!quizActive) {
                        currentQuizIndex = index;
                        showQuiz(point);
                    }
                }, delay);

                quizTimeout.push(timerId);
            }
        });
        
        document.getElementById('status-msg').textContent = 'âœ… äº’å‹•è¨ˆæ™‚å™¨å·²å•Ÿå‹•ã€‚';
        document.getElementById('status-msg').classList.remove('text-blue-500', 'bg-blue-50');
        document.getElementById('status-msg').classList.add('text-green-600', 'bg-green-50');
    }

    /**
     * é¡¯ç¤ºæ¸¬é©—é¡Œç›®å½ˆçª—
     */
    function showQuiz(point) {
        quizActive = true;
        
        document.getElementById('quiz-question').textContent = point.question;
        
        const optionsContainer = document.getElementById('quiz-options');
        optionsContainer.innerHTML = ''; // æ¸…ç©ºèˆŠé¸é …
        
        point.options.forEach((option, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn font-medium text-gray-700';
            btn.textContent = option;
            btn.onclick = () => checkAnswer(btn, index);
            optionsContainer.appendChild(btn);
        });

        // é‡ç½®å›é¥‹å€å¡Š
        document.getElementById('rationale-box').classList.add('hidden');
        document.getElementById('continue-btn').classList.add('hidden');
        
        document.getElementById('quiz-overlay').style.display = 'flex';
        
        // æ¸…é™¤æ‰€æœ‰æœªä¾†çš„æ¸¬é©—è¨ˆæ™‚å™¨ï¼Œç›´åˆ°å­¸ç”Ÿå›ç­”å®Œç•¢
        clearAllTimeouts();
    }
    
    /**
     * æ¸…é™¤æ‰€æœ‰æœªè§¸ç™¼çš„è¨ˆæ™‚å™¨
     */
    function clearAllTimeouts() {
        quizTimeout.forEach(id => clearTimeout(id));
        quizTimeout = [];
    }


    /**
     * æª¢æŸ¥ç­”æ¡ˆ
     */
    function checkAnswer(clickedButton, selectedIndex) {
        const point = QUIZ_POINTS[currentQuizIndex];
        const isCorrect = selectedIndex === point.answerIndex;
        const allButtons = document.getElementById('quiz-options').querySelectorAll('.option-btn');
        
        // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•ä¸¦æ¨™è¨˜çµæœ
        allButtons.forEach(btn => {
            btn.disabled = true;
            if (point.options.indexOf(btn.textContent) === point.answerIndex) {
                btn.classList.add('correct-answer');
            }
        });

        if (!isCorrect) {
            clickedButton.classList.add('incorrect-selection');
        }

        // é¡¯ç¤ºå›é¥‹å’Œè§£æ
        const rationaleBox = document.getElementById('rationale-box');
        const feedbackResult = document.getElementById('feedback-result');
        const feedbackRationale = document.getElementById('feedback-rationale');
        
        feedbackResult.textContent = isCorrect ? 'âœ… å›ç­”æ­£ç¢ºï¼' : 'âŒ ç­”éŒ¯äº†ï¼';
        feedbackRationale.textContent = point.rationale;
